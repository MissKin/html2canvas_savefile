<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <title>截图</title>
	<style>
		.test{
			width:400px;
			height:400px;
			border:1px solid #dddddd;
			background-image:url('http://tpc.googlesyndication.com/daca_images/simgad/2993831694882486956');
		}
	</style>
	</head>
	<body>
		<div id='box' class='test'>
		<p>你好呀</p>
		</div>
		<button onclick="test()">生成</button>				
	<script type="text/javascript"src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		<script src='./html2canvas.js'></script>
	<script>
	var dataURL;
	var imgData ='';
		function test(){
			var img = document.getElementsByTagName('img')[0];
			var box=document.getElementById('box');
			html2canvas(box).then(function(canvas) {
			    canvas.id='canvas1';
				//console.log(dataURL.substring(0,22));
				box.innerHTML ='';
				box.appendChild(canvas);
				
				 // 下载后的问题名
				var filename = '二维码 .png';
				
				var canvasData = document.getElementById('canvas1');
			    imgData = canvas.toDataURL();
				saveFile(imgData,filename)	
			});
		}
		function say(){
			alert('另外一个方法');
			var canvasData = document.getElementById('canvas1');
			   var newImg = new Image();
					newImg.setAttribute('crossOrigin', '*');
					newImg.id='newImg';
					 newImg.src = dataURL;
					console.log(newImg);
					document.body.appendChild(newImg);
		}
		
		function saveFile(data,filename){
			var save_link = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');
			save_link.href= data;
			save_link.download = filename;
			console.log(save_link);
			var event = document.createEvent('MouseEvents');
			 event.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
			 save_link.dispatchEvent(event);
		}
		
	
		
		 
	</script>
	</body>
</html>